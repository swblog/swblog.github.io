# 行操作

## 操作快捷键

Unix命令行采用Readline库。它提供了许多快捷键，用来快速完成各种操作。快捷键用到`Ctrl`和`Alt`键，其中`Alt`键也可以用`Esc`键代替。

移动操作的主要快捷键。

- `Ctrl-a` 光标移到行首
- `Ctrl-e` 光标移到行尾
- `Ctrl-f` 光标向右移动一个字符，与右箭头作用相同
- `Ctrl-b` 光标向左移动一个字符，与左箭头作用相同
- `Alt-f` 光标向右移动一个词
- `Alt-b` 光标向左移动一个词
- `Ctrl-l` 清除屏幕，光标移到左上角，与`clear`命令作用相同

编辑操作的主要快捷键。

- `Ctrl-d` 删除光标位置的字符
- `Ctrl-t` 光标位置的字符与它前面一位的字符交换位置
- `Alt-t` 光标位置的词与它前面一位的词交换位置
- `Alt-l` 将光标位置至词尾转为小写
- `Alt-u` 将光标位置至词尾转为大写

剪切和粘贴操作的主要快捷键。

- `Ctrl-k` 剪切光标位置到行尾的文本
- `Ctrl-u` 剪切光标位置到行首的文本
- `Alt-d` 剪切光标位置到词尾的文本
- `Alt-Backspace` 剪切光标位置到词首的文本
- `Ctrl-y` 在光标位置粘贴文本

## 自动补全

`tab`键可以自动补全路径。

```bash
$ ls l
```

上面的命令按下`tab`键，如果当前目录只有一个`l`开头的文件名或子目录，则会自动补全这个路径。如果有多个`l`开头的文件名或子目录，则连按两次`tab`键，会显示所有符合条件的路径，用来提示。

`tab`还可以补全其他值，如果一个值以`$`开头，则补全变量；如果以`~`开头，则补全用户名；如果该词是命令行第一个词，则补全命令；如果以`@`开头，则补全主机名（hostname），以列在`/etc/hosts`文件里面的主机为准。

- `Alt-?` 列出可能的补全，与连按两次`tab`键作用相同
- `Alt-*` 在命令行插入所有可能的补全

## 操作历史

Bash的操作历史存放在用户主目录的`.bash_history`文件中，默认储存500个操作。

`history`命令用来展示这个文件。

```bash
$ history | less
```

在该文件之中，搜索或执行某个命令，执行下面的命令。

```bash
# 搜索某个命令
$ history | grep /usr/bin

# 执行 .bash_history 文件中第88个命令
$ !88
```

还有一种更简便的搜索方式，就是按下`Ctrl + r`，然后每键入一个字符，Shell会自动在历史文件中，查询并显示最近一个匹配的结果。查到想要的命令时，按下回车键就会执行该命令；按下`Ctrl + j`，就会将这个命令拷贝到命令行。

下面是一些与操作历史相关的快捷键。

- `Ctrl - p` 显示上一个命令，与向上箭头效果相同
- `Ctrl - n` 显示下一个命令，与向下箭头效果相同
- `Alt - <` 显示第一个命令
- `Alt - >` 显示最后一个命令，即当前的命令
- `Ctrl - r` 逆向搜索操作历史
- `Alt - p` 逆向搜索操作历史，但不会每个字母都显示，而是键入整个字符以后，一次性搜索
- `Alt - n` 正向搜索
- `Ctrl - o` 执行历史文件里面的当前条目，并自动显示下一条命令。这对重复执行某个序列的命令很有帮助。

感叹号可以用于执行历史文件里面的命令。

- `!!` 执行上一个命令
- `!number` 执行历史文件里面指定行号的命令
- `!string` 执行上一个以指定字符串开头的命令
- `!?string` 执行上一个包含指定字符串的命令

